{\rtf1\ansi\ansicpg950\cocoartf2822
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\fnil\fcharset0 .SFNS-Regular;}
{\colortbl;\red255\green255\blue255;\red14\green14\blue14;}
{\*\expandedcolortbl;;\cssrgb\c6700\c6700\c6700;}
\paperw11900\paperh16840\margl1440\margr1440\vieww34000\viewh21380\viewkind0
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\sl324\slmult1\pardirnatural\partightenfactor0

\f0\fs28 \cf2 <!DOCTYPE html>\
<html lang="zh-Hant">\
<head>\
<meta charset="utf-8" />\
<meta name="viewport" content="width=device-width, initial-scale=1" />\
<title>\uc0\u23478 \u25945 \u19978 \u35506 \u32000 \u37636 </title>\
<style>\
  :root\{\
    --bg:#0f1222; --card:#171a2b; --ink:#e8ebff; --muted:#a6acd3;\
    --accent:#7c9dff; --ok:#39d98a; --danger:#ff6b6b; --radius:14px;\
  \}\
  *\{box-sizing:border-box\} html,body\{height:100%\}\
  body\{margin:0; font-family:system-ui,-apple-system,"Noto Sans TC",Segoe UI,Roboto,Ubuntu,sans-serif;\
       color:var(--ink); background:linear-gradient(180deg,#0a0c18,#0f1222); padding:20px\}\
  .wrap\{max-width:960px; margin:0 auto; display:grid; gap:16px\}\
  header\{display:flex; align-items:center; justify-content:space-between; gap:12px; flex-wrap:wrap\}\
  h1\{margin:0; font-size:20px\}\
  .sub\{color:var(--muted); font-size:12px\}\
  .card\{background:color-mix(in oklab, var(--card) 86%, black 14%);\
        border:1px solid rgba(255,255,255,.08); border-radius:var(--radius); padding:16px\}\
  .grid\{display:grid; grid-template-columns:1fr 1fr; gap:12px\}\
  @media (max-width:720px)\{ .grid\{grid-template-columns:1fr\} \}\
  label\{display:block; font-size:12px; color:var(--muted); margin:4px 2px\}\
  input[type="date"], input[type="time"], select, textarea\{\
    width:100%; background:#0f1325; border:1px solid rgba(255,255,255,.12);\
    color:var(--ink); padding:10px 12px; border-radius:10px; outline:none;\
  \}\
  textarea\{min-height:46px; resize:vertical\}\
  input:focus, select:focus, textarea:focus\{box-shadow:0 0 0 3px rgba(124,157,255,.25)\}\
  .actions\{display:flex; gap:10px; flex-wrap:wrap\}\
  .btn\{border:none; padding:10px 14px; border-radius:10px; font-weight:700; cursor:pointer\}\
  .btn.primary\{background:linear-gradient(180deg,var(--accent),#5b7cff); color:#081022\}\
  .btn.ok\{background:linear-gradient(180deg,var(--ok),#18b676); color:#062016\}\
  .btn.secondary\{background:linear-gradient(180deg,#2c3152,#1c2140); color:var(--ink);\
    border:1px solid rgba(255,255,255,.08)\}\
  .btn.danger\{background:linear-gradient(180deg,#ff8383,var(--danger)); color:#3a0d0d\}\
  .table-wrap\{overflow:auto; border-radius:12px; border:1px solid rgba(255,255,255,.08)\}\
  table\{width:100%; border-collapse:collapse; min-width:720px; background:#0f1325\}\
  th,td\{padding:10px; border-bottom:1px solid rgba(255,255,255,.08); text-align:left; font-size:14px\}\
  th\{background:#141838; color:#cfd6ff; position:sticky; top:0\}\
  tbody tr:hover\{background:#151a39\}\
  .pill\{padding:4px 8px; border-radius:999px; font-size:12px; background:rgba(124,157,255,.15);\
        color:#cfe0ff; border:1px solid rgba(124,157,255,.25)\}\
  .muted\{color:var(--muted); font-size:12px\}\
  footer\{display:flex; justify-content:space-between; align-items:center; gap:8px; flex-wrap:wrap; color:var(--muted); font-size:12px\}\
</style>\
</head>\
<body>\
<div class="wrap">\
  <header>\
    <div>\
      <h1>\uc0\u23478 \u25945 \u19978 \u35506 \u32000 \u37636 </h1>\
      <div class="sub">\uc0\u36984 \u26085 \u26399 \u12289 \u38283 \u22987 \u26178 \u38291 \u12289 \u26178 \u38263 \u12290 \u36039 \u26009 \u20445 \u23384 \u22312 \u26412 \u27231 \u65292 \u21487 \u21295 \u20986  CSV\u12290 </div>\
    </div>\
    <div class="actions">\
      <button class="btn secondary" id="exportBtn">\uc0\u21295 \u20986  CSV</button>\
      <button class="btn danger" id="clearBtn">\uc0\u28165 \u31354 \u20840 \u37096 </button>\
    </div>\
  </header>\
\
  <section class="card">\
    <div class="grid">\
      <div>\
        <label for="date">\uc0\u26085 \u26399 \u65288 \u21488 \u21271 \u26178 \u38291 \u65289 </label>\
        <input id="date" type="date" />\
      </div>\
      <div>\
        <label for="time">\uc0\u38283 \u22987 \u26178 \u38291 </label>\
        <input id="time" type="time" step="300" />\
      </div>\
      <div>\
        <label for="dur">\uc0\u26178 \u38263 </label>\
        <select id="dur">\
          <option value="60">1 \uc0\u23567 \u26178 </option>\
          <option value="90">1.5 \uc0\u23567 \u26178 </option>\
          <option value="120">2 \uc0\u23567 \u26178 </option>\
        </select>\
      </div>\
      <div>\
        <label for="note">\uc0\u20633 \u35387 \u65288 \u36984 \u22635 \u65289 </label>\
        <textarea id="note" placeholder="\uc0\u20363 \u22914 \u65306 \u31532  7 \u31456  7-3 \u38988 \u22411  B\u65292 \u28204 \u39511  80 \u20998 "></textarea>\
      </div>\
    </div>\
    <div style="height:10px"></div>\
    <div class="actions">\
      <button class="btn ok" id="addBtn">\uc0\u26032 \u22686 \u32000 \u37636 </button>\
      <span class="muted">\uc0\u26178 \u21312 \u22266 \u23450 \u28858  Asia/Taipei\u65307 \u39023 \u31034 \u28858  24 \u23567 \u26178 \u21046 \u12290 </span>\
    </div>\
  </section>\
\
  <section class="card">\
    <div class="muted" style="margin-bottom:8px">\uc0\u19978 \u35506 \u32000 \u37636 </div>\
    <div class="table-wrap">\
      <table aria-describedby="tblHelp">\
        <thead>\
          <tr>\
            <th>#</th>\
            <th>\uc0\u26085 \u26399 </th>\
            <th>\uc0\u38283 \u22987 </th>\
            <th>\uc0\u32080 \u26463 </th>\
            <th>\uc0\u26178 \u38263 </th>\
            <th>\uc0\u20633 \u35387 </th>\
            <th>\uc0\u25805 \u20316 </th>\
          </tr>\
        </thead>\
        <tbody id="tbody"></tbody>\
      </table>\
    </div>\
    <div id="tblHelp" class="muted" style="margin-top:8px">\uc0\u40670 \u12300 \u21034 \u38500 \u12301 \u21487 \u31227 \u38500 \u21934 \u31558 \u65307 \u20633 \u35387 \u21487 \u30452 \u25509 \u32232 \u36655 \u12290 </div>\
  </section>\
\
  <footer class="card">\
    <div>\'a9 <span id="yy"></span> \uc0\u23478 \u25945 \u32000 \u37636 \u12290 \u28418 \u20142 \u12289 \u23433 \u38748 \u12289 \u19981 \u22217 \u21990 \u12290 </div>\
    <div>\uc0\u26412 \u27231 \u20786 \u23384 \u37749 \u65306 <code style="background:#0a0c18; padding:2px 6px; border-radius:6px">tutor_sessions_v3</code></div>\
  </footer>\
</div>\
\
<script>\
(function()\{\
  "use strict";\
  const tz = "Asia/Taipei";\
  const storageKey = "tutor_sessions_v3";\
  const $ = (id)=>document.getElementById(id);\
  const els = \{\
    date: $("date"), time: $("time"), dur: $("dur"), note: $("note"),\
    addBtn: $("addBtn"), tbody: $("tbody"), exportBtn: $("exportBtn"), clearBtn: $("clearBtn"),\
    yy: $("yy")\
  \};\
  els.yy.textContent = new Date().getFullYear();\
\
  // Defaults: today and next rounded 5-min\
  function todayISODateInTZ()\{\
    // \uc0\u22266 \u23450 \u21488 \u21271 \u26178 \u21312  +08:00\u65288 \u28961  DST\u65289 \
    const now = new Date();\
    const y = now.getUTCFullYear();\
    const m = now.getUTCMonth();\
    const d = now.getUTCDate();\
    // \uc0\u36681 \u28858 \u21488 \u21271 \u26178 \u38291 \u26085 \u26399 \u23383 \u20018 \
    const tpe = new Date(now.toLocaleString("en-US", \{ timeZone: tz \}));\
    return tpe.toISOString().slice(0,10);\
  \}\
  function defaultTime()\{\
    const tpe = new Date(new Date().toLocaleString("en-US",\{timeZone:tz\}));\
    const mins = tpe.getMinutes();\
    const rounded = Math.round(mins/5)*5;\
    tpe.setMinutes(rounded,0,0);\
    const hh = String(tpe.getHours()).padStart(2,"0");\
    const mm = String(tpe.getMinutes()).padStart(2,"0");\
    return `$\{hh\}:$\{mm\}`;\
  \}\
  els.date.value = todayISODateInTZ();\
  els.time.value = defaultTime();\
\
  let sessions = load();\
\
  function load()\{\
    try\{ return JSON.parse(localStorage.getItem(storageKey) || "[]"); \}catch(e)\{ return []; \}\
  \}\
  function save()\{ localStorage.setItem(storageKey, JSON.stringify(sessions)); \}\
\
  const fmtDate = (d)=> new Intl.DateTimeFormat("zh-Hant-TW",\{ timeZone: tz, dateStyle:"medium" \}).format(d);\
  const fmtTime = (d)=> new Intl.DateTimeFormat("zh-Hant-TW",\{ timeZone: tz, hour:"2-digit", minute:"2-digit", hour12:false \}).format(d);\
  const pad2 = (n)=> String(n).padStart(2,"0");\
\
  function parseTpeDateTime(dateStr, timeStr)\{\
    // \uc0\u23559  yyyy-mm-dd \u33287  HH:MM \u32068 \u25104  +08:00 \u26178 \u38291 \
    return new Date(`$\{dateStr\}T$\{timeStr\}:00+08:00`);\
  \}\
\
  function addRecord()\{\
    const dateStr = String(els.date.value || "").trim();\
    const timeStr = String(els.time.value || "").trim();\
    const durMin = parseInt(els.dur.value, 10);\
    if(!dateStr || !timeStr || isNaN(durMin))\{\
      alert("\uc0\u35531 \u30906 \u35469 \u26085 \u26399 \u12289 \u26178 \u38291 \u33287 \u26178 \u38263 \u30342 \u24050 \u22635 \u23531 \u12290 ");\
      return;\
    \}\
    const start = parseTpeDateTime(dateStr, timeStr);\
    const end = new Date(start.getTime() + durMin*60000);\
    const rec = \{\
      id: cryptoId(),\
      startISO: start.toISOString(),\
      endISO: end.toISOString(),\
      durationMin: durMin,\
      note: String(els.note.value || "").trim()\
    \};\
    sessions.push(rec);\
    save(); render();\
    // \uc0\u20445 \u30041 \u26085 \u26399 \u33287 \u26178 \u38291 \u65292 \u28165 \u31354 \u20633 \u35387 \u23601 \u22909 \
    els.note.value = "";\
  \}\
\
  function render()\{\
    els.tbody.innerHTML = "";\
    const list = [...sessions].sort((a,b)=> new Date(b.startISO) - new Date(a.startISO));\
    list.forEach((s, idx)=>\{\
      const tr = document.createElement("tr");\
      const dStart = new Date(s.startISO);\
      const dEnd = new Date(s.endISO);\
      const hh = Math.floor(s.durationMin/60), mm = s.durationMin%60;\
      tr.innerHTML = `\
        <td>$\{list.length - idx\}</td>\
        <td>$\{fmtDate(dStart)\}</td>\
        <td><span class="pill">$\{fmtTime(dStart)\}</span></td>\
        <td><span class="pill">$\{fmtTime(dEnd)\}</span></td>\
        <td><strong>$\{pad2(hh)\}:$\{pad2(mm)\}</strong></td>\
        <td><input class="note-edit" data-id="$\{s.id\}" value="$\{escapeAttr(s.note||"")\}" /></td>\
        <td><button class="btn secondary" data-act="del" data-id="$\{s.id\}">\uc0\u21034 \u38500 </button></td>\
      `;\
      els.tbody.appendChild(tr);\
    \});\
    // note \uc0\u32232 \u36655 \
    els.tbody.querySelectorAll(".note-edit").forEach(input=>\{\
      input.addEventListener("change", e=>\{\
        const id = e.target.getAttribute("data-id");\
        const rec = sessions.find(x=> x.id === id);\
        if(rec)\{ rec.note = String(e.target.value || "").trim(); save(); \}\
      \});\
    \});\
    // \uc0\u21034 \u38500 \
    els.tbody.querySelectorAll("[data-act='del']").forEach(btn=>\{\
      btn.addEventListener("click", ()=>\{\
        const id = btn.getAttribute("data-id");\
        if(confirm("\uc0\u30906 \u23450 \u21034 \u38500 \u27492 \u31558 \u32000 \u37636 \u65311 "))\{\
          sessions = sessions.filter(x=> x.id !== id);\
          save(); render();\
        \}\
      \});\
    \});\
  \}\
\
  function exportCSV()\{\
    const rows = [["\uc0\u26085 \u26399 ","\u38283 \u22987 \u26178 \u38291 ","\u32080 \u26463 \u26178 \u38291 ","\u26178 \u38263 (\u20998 \u37912 )","\u20633 \u35387 "]];\
    const list = [...sessions].sort((a,b)=> new Date(a.startISO) - new Date(b.startISO));\
    list.forEach(s=>\{\
      const dStart = new Date(s.startISO);\
      const dEnd = new Date(s.endISO);\
      rows.push([\
        fmtDate(dStart),\
        fmtTime(dStart),\
        fmtTime(dEnd),\
        String(s.durationMin),\
        s.note || ""\
      ]);\
    \});\
    const csv = rows.map(r => r.map(csvCell).join(",")).join("\\r\\n");\
    const blob = new Blob([csv], \{type:"text/csv;charset=utf-8"\});\
    const url = URL.createObjectURL(blob);\
    const a = document.createElement("a");\
    const stamp = new Date().toISOString().slice(0,19).replace(/[:T]/g,"");\
    a.href = url; a.download = `tutor_records_$\{stamp\}.csv`;\
    document.body.appendChild(a); a.click(); a.remove();\
    URL.revokeObjectURL(url);\
  \}\
\
  function clearAll()\{\
    if(confirm("\uc0\u36889 \u26371 \u21034 \u38500 \u26412 \u27231 \u25152 \u26377 \u32000 \u37636 \u19988 \u28961 \u27861 \u24489 \u21407 \u65292 \u30906 \u23450 \u21966 \u65311 "))\{\
      sessions = []; save(); render();\
    \}\
  \}\
\
  function csvCell(v)\{ const s = String(v ?? ""); return `"$\{s.replace(/"/g,'""')\}"`; \}\
  function escapeAttr(s)\{ return String(s).replace(/[&<>"']/g, c=>(\{ "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;" \}[c])).replace(/\\n/g,"&#10;"); \}\
  function cryptoId()\{\
    if (crypto?.getRandomValues)\{\
      const b = new Uint8Array(8); crypto.getRandomValues(b);\
      return Array.from(b, x=>x.toString(16).padStart(2,"0")).join("");\
    \}\
    return String(Math.random()).slice(2);\
  \}\
\
  els.addBtn.addEventListener("click", addRecord);\
  els.exportBtn.addEventListener("click", exportCSV);\
  els.clearBtn.addEventListener("click", clearAll);\
\
  render();\
\})();\
</script>\
</body>\
</html>}